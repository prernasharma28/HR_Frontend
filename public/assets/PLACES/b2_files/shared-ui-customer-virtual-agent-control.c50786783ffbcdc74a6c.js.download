/*@license For license information please refer to shared-ui-customer-virtual-agent-control.licenses.txt*/
(self.webpackChunkblossom_flex_ui=self.webpackChunkblossom_flex_ui||[]).push([[7678],{38083:function(n,e,t){t.d(e,{LC:function(){return _},V6:function(){return j},X4:function(){return T}});var o=t(67294),i=t(25354),r=t(92787),l=t(95878),a=t(85395),u=t(17684);function s(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,o=new Array(e);t<e;t++)o[t]=n[t];return o}function c(n,e,t,o,i,r,l){try{var a=n[r](l),u=a.value}catch(s){return void t(s)}a.done?e(u):Promise.resolve(u).then(o,i)}function v(n){return function(){var e=this,t=arguments;return new Promise((function(o,i){var r=n.apply(e,t);function l(n){c(r,o,i,l,a,"next",n)}function a(n){c(r,o,i,l,a,"throw",n)}l(void 0)}))}}function d(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function p(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),o.forEach((function(e){p(n,e,t[e])}))}return n}function b(n,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):function(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,o)}return t}(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})),n}function h(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,i,r=[],l=!0,a=!1;try{for(t=t.call(n);!(l=(o=t.next()).done)&&(r.push(o.value),!e||r.length!==e);l=!0);}catch(u){a=!0,i=u}finally{try{l||null==t.return||t.return()}finally{if(a)throw i}}return r}}(n,e)||function(n,e){if(!n)return;if("string"==typeof n)return s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(n,e)}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function g(n,e){var t,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(!(i=l.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){l=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){l.label=r[1];break}if(6===r[0]&&l.label<i[1]){l.label=i[1],i=r;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(r);break}i[2]&&l.ops.pop(),l.trys.pop();continue}r=e.call(n,l)}catch(a){r=[6,a],o=0}finally{t=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function y(){var n=P(["\n  query ChatbotConfigQuery($context: ContextInput!, $applicationName: String!) {\n    chatbotConfig(context: $context, applicationName: $applicationName) {\n      authToken\n      channelOriginId\n      chatbotCapabilities\n      conversationProperties {\n        launchPoint\n        traceId\n      }\n      enableAutoOpenChatWidget\n      enableProactiveConversation\n      version {\n        javascriptUrl {\n          value\n        }\n        versionId\n      }\n    }\n  }\n"]);return y=function(){return n},n}function C(){var n=P(["\n  query localChatClient {\n    localChatClientState @client {\n      requested\n      isEventHandlerRegistered\n    }\n  }\n"]);return C=function(){return n},n}var w=Object.defineProperty,m=function(n,e,t){return function(n,e,t){e in n?w(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t}(n,"symbol"!==(void 0===e?"undefined":function(n){return n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n}(e))?e+"":e,t),t};function O(){return(O=v((function(n){var e,t;return g(this,(function(o){return(null===(e=window)||void 0===e?void 0:e.virtualAgentControl)?[2,window.virtualAgentControl]:(null===(t=window)||void 0===t?void 0:t.VacClientAdapter)?[2,window.VacClientAdapter.getInstance(n)]:[2,void 0]}))}))).apply(this,arguments)}function I(){return A.apply(this,arguments)}function A(){return(A=v((function(){var n,e,t,o,i,r;return g(this,(function(l){switch(l.label){case 0:return(i=null===(n=window)||void 0===n?void 0:n.virtualAgentControl)?[4,window.virtualAgentControl.isInitialized]:[3,2];case 1:i=l.sent(),l.label=2;case 2:return i?[2,window.virtualAgentControl]:(null===(t=window)||void 0===t||null===(e=t.VirtualAgentControl)||void 0===e?void 0:e.initialized)&&(null===(o=window)||void 0===o?void 0:o.VacClientAdapter)?[4,window.VirtualAgentControl.initialized]:[3,6];case 3:return l.sent()?[4,window.VacClientAdapter.getInstance()]:[3,6];case 4:return[4,(r=l.sent()).isInitialized];case 5:if(l.sent())return[2,r];l.label=6;case 6:return[2,void 0]}}))}))).apply(this,arguments)}function T(n){return S.apply(this,arguments)}function S(){return(S=v((function(n){var e,t,o,i,r;return g(this,(function(l){switch(l.label){case 0:return[4,I()];case 1:return e=l.sent(),o=(t=n||{}).intentMessage,i=t.conversationProperties,r=t.silent,e&&(o||i)&&e.setConversationContext({intentMessage:o,conversationProperties:i},r),[2]}}))}))).apply(this,arguments)}var _=function(){function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),m(this,"data",{isInitialized:!1}),m(this,"stateFieldName","virtualAgentControlState"),m(this,"events",["virtualAgentInitialized","virtualAgentIntentMessage"])}var e,t,o;return e=n,(t=[{key:"update",value:function(n,e,t){var o;return"virtualAgentInitialized"===n?Object.assign({},e,{isInitialized:!0}):"virtualAgentIntentMessage"===n&&(null===(o=t)||void 0===o?void 0:o.data)&&t.data.intent?Object.assign({},e,{intentMessage:t.data}):e}}])&&d(e.prototype,t),o&&d(e,o),n}(),E=(0,i.Ps)(y()),k=(0,i.Ps)(C()),N={__typename:"LocalChatClientState",requested:!1},j=function(n){var e,t,i,s,c,v,d=n.applicationName,p=n.clientOverrides,P=n.pageName,g=n.skipSsr,y=(0,l.v)().context,C=(0,a.useLogger)(),w=C.error,m=C.info,A=y.locale,T={context:y,applicationName:d},S=h(o.useState(),2),_=S[0],j=S[1],x=h(o.useState(!1),2),R=x[0],V=x[1],D=h((0,u.gw)(),2)[1],M=Boolean(_),z=(0,r.a)(E,{variables:T,ssr:!g,skip:M}).data,L=(0,r.a)(k,{ssr:!g}),q=L.data,B=L.client,H=function(){D({type:"virtualAgentInitialized"})},W=function(){return w("STRATBOT_VAC_SCRIPT_FAILED_TO_LOAD")};o.useEffect((function(){var n;if(!_)if(!(null===(n=z)||void 0===n?void 0:n.chatbotConfig)||q&&q.localChatClientState.requested||R)I().then((function(n){n&&(j(n),H())}));else{var e;V(!0),B.writeQuery({query:k,data:b(f({},z||{}),{localChatClientState:b(f({},N),{requested:!0,isEventHandlerRegistered:!0})})});var t=z.chatbotConfig,o=z.chatbotConfig.version.javascriptUrl,i=(null===(e=p)||void 0===e?void 0:e.authToken)||function(n){if("function"==typeof window.atob){var e=window.atob(n);return JSON.parse(e)}}(t.authToken),r=function(n,e,t,o,i){var r,l,a,u,s,c,v,d,p,f,b,h,P,g,y,C,w,m,O,I,A,T,S,_,E,k,N,j,x,R,V,D,M,z,L,q,B,H,W,F,G,U,$,Q,X,J,K,Y,Z,nn,en,tn,on,rn,ln,an,un,sn,cn,vn,dn,pn,fn,bn,hn,Pn,gn,yn,Cn,wn,mn,On,In,An,Tn,Sn,_n,En,kn,Nn,jn,xn,Rn,Vn,Dn,Mn={authToken:o,channelOriginId:(null===(r=i)||void 0===r?void 0:r.channelOriginId)||(null===(l=n)||void 0===l?void 0:l.channelOriginId),capabilities:(null===(a=n)||void 0===a?void 0:a.chatbotCapabilities)?(ln=null===(u=n)||void 0===u?void 0:u.chatbotCapabilities,ln.map((function(n){switch(n){case"CLICKSTREAM":return"Clickstream";case"GLASSBOX":return"Glassbox";default:return""}})).filter((function(n){return""!==n}))):[],containerElement:null===(s=i)||void 0===s?void 0:s.containerElement,conversationProperties:{launchPoint:(null===(v=i)||void 0===v||null===(c=v.conversationProperties)||void 0===c?void 0:c.launchPoint)||(null===(d=n)||void 0===d?void 0:d.conversationProperties.launchPoint),traceId:null===(p=n)||void 0===p?void 0:p.conversationProperties.traceId,pageName:e},embedded:null===(f=i)||void 0===f?void 0:f.embedded,enableAutoOpenChatWidget:(null===(b=i)||void 0===b?void 0:b.enableAutoOpenChatWidget)||(null===(h=n)||void 0===h?void 0:h.enableAutoOpenChatWidget),enableProactiveConversation:(null===(P=i)||void 0===P?void 0:P.enableProactiveConversation)||(null===(g=n)||void 0===g?void 0:g.enableProactiveConversation),fastRender:"V2"===(null===(y=n)||void 0===y?void 0:y.version.versionId),intentMessage:null===(C=i)||void 0===C?void 0:C.intentMessage,languageId:(null===(w=i)||void 0===w?void 0:w.languageId)||t,subscribedEvents:null===(m=i)||void 0===m?void 0:m.subscribedEvents,eventHandler:null===(O=i)||void 0===O?void 0:O.eventHandler,userProperties:null===(I=i)||void 0===I?void 0:I.userProperties,configurationOverrides:null===(A=i)||void 0===A?void 0:A.configurationOverrides};return(null===(S=i)||void 0===S||null===(T=S.conversationProperties)||void 0===T?void 0:T.skipWelcome)&&(Mn.conversationProperties.skipWelcome=null===(un=i)||void 0===un||null===(an=un.conversationProperties)||void 0===an?void 0:an.skipWelcome),(null===(E=i)||void 0===E||null===(_=E.conversationProperties)||void 0===_?void 0:_.listingId)&&(Mn.conversationProperties.listingId=null===(cn=i)||void 0===cn||null===(sn=cn.conversationProperties)||void 0===sn?void 0:sn.listingId),(null===(N=i)||void 0===N||null===(k=N.conversationProperties)||void 0===k?void 0:k.checkin)&&(Mn.conversationProperties.checkin=null===(dn=i)||void 0===dn||null===(vn=dn.conversationProperties)||void 0===vn?void 0:vn.checkin),(null===(x=i)||void 0===x||null===(j=x.conversationProperties)||void 0===j?void 0:j.checkout)&&(Mn.conversationProperties.checkout=null===(fn=i)||void 0===fn||null===(pn=fn.conversationProperties)||void 0===pn?void 0:pn.checkout),(null===(V=i)||void 0===V||null===(R=V.conversationProperties)||void 0===R?void 0:R.adults)&&(Mn.conversationProperties.adults=null===(hn=i)||void 0===hn||null===(bn=hn.conversationProperties)||void 0===bn?void 0:bn.adults),(null===(M=i)||void 0===M||null===(D=M.conversationProperties)||void 0===D?void 0:D.children)&&(Mn.conversationProperties.children=null===(gn=i)||void 0===gn||null===(Pn=gn.conversationProperties)||void 0===Pn?void 0:Pn.children),(null===(L=i)||void 0===L||null===(z=L.conversationProperties)||void 0===z?void 0:z.pets)&&(Mn.conversationProperties.pets=null===(Cn=i)||void 0===Cn||null===(yn=Cn.conversationProperties)||void 0===yn?void 0:yn.pets),(null===(B=i)||void 0===B||null===(q=B.conversationProperties)||void 0===q?void 0:q.currency)&&(Mn.conversationProperties.currency=null===(mn=i)||void 0===mn||null===(wn=mn.conversationProperties)||void 0===wn?void 0:wn.currency),(null===(W=i)||void 0===W||null===(H=W.conversationProperties)||void 0===H?void 0:H.device)&&(Mn.conversationProperties.device=null===(In=i)||void 0===In||null===(On=In.conversationProperties)||void 0===On?void 0:On.device),(null===(G=i)||void 0===G||null===(F=G.conversationProperties)||void 0===F?void 0:F.bookNow)&&(Mn.conversationProperties.bookNow=null===(Tn=i)||void 0===Tn||null===(An=Tn.conversationProperties)||void 0===An?void 0:An.bookNow),(null===($=i)||void 0===$||null===(U=$.conversationProperties)||void 0===U?void 0:U.havId)&&(Mn.conversationProperties.havId=null===(_n=i)||void 0===_n||null===(Sn=_n.conversationProperties)||void 0===Sn?void 0:Sn.havId),(null===(X=i)||void 0===X||null===(Q=X.conversationProperties)||void 0===Q?void 0:Q.site)&&(Mn.conversationProperties.site=null===(kn=i)||void 0===kn||null===(En=kn.conversationProperties)||void 0===En?void 0:En.site),(null===(K=i)||void 0===K||null===(J=K.conversationProperties)||void 0===J?void 0:J.hostname)&&(Mn.conversationProperties.hostname=null===(jn=i)||void 0===jn||null===(Nn=jn.conversationProperties)||void 0===Nn?void 0:Nn.hostname),(null===(Z=i)||void 0===Z||null===(Y=Z.conversationProperties)||void 0===Y?void 0:Y.chatbotName)&&(Mn.conversationProperties.chatbotName=null===(Rn=i)||void 0===Rn||null===(xn=Rn.conversationProperties)||void 0===xn?void 0:xn.chatbotName),(null===(en=i)||void 0===en||null===(nn=en.conversationProperties)||void 0===nn?void 0:nn.chatbotEntryPoint)&&(Mn.conversationProperties.chatbotEntryPoint=null===(Dn=i)||void 0===Dn||null===(Vn=Dn.conversationProperties)||void 0===Vn?void 0:Vn.chatbotEntryPoint),(null===(tn=i)||void 0===tn?void 0:tn.conversationId)&&(null===(on=i)||void 0===on?void 0:on.participantId)&&(null===(rn=i)||void 0===rn?void 0:rn.mode)&&(Mn.conversationId=i.conversationId,Mn.participantId=i.participantId,Mn.mode=i.mode),Mn}(t,P,A,i,p);document.head.appendChild(function(n,e,t){var o=document.createElement("script");return o.src=n,o.onload=e,o.onerror=t,o}(o.value,(function(){(function(n){return O.apply(this,arguments)})(i).then((function(n){n?n.initialize(r).then((function(){I().then((function(n){n?(j(n),H(),m("STRATBOT_VAC_INIT_SUCCEEDED")):w("STRATBOT_VAC_INIT_NO_VALID_CHAT_CLIENT_FOUND")}))})).catch((function(n){w("STRATBOT_VAC_INIT_FAILED",n)})):w("STRATBOT_VAC_FAILED_TO_FIND_INSTANCE_TO_INIT")})).catch((function(n){w("STRATBOT_VAC_ERROR_GETTING_INSTANCE_TO_INIT",n)}))}),W))}}),[_,z,q,R,B,P,A,p,H,w,m,W]),o.useEffect((function(){var n=p||{},e=n.intentMessage,t=n.conversationProperties,o=n.silent,i=void 0===o||o;if(_&&(e||t)){var r=Object.assign(t||{},{pageName:P});_.setConversationContext({intentMessage:e,conversationProperties:r},i)}}),[null===(t=p)||void 0===t||null===(e=t.intentMessage)||void 0===e?void 0:e.intent,null===(s=p)||void 0===s||null===(i=s.conversationProperties)||void 0===i?void 0:i.launchPoint,null===(v=p)||void 0===v||null===(c=v.conversationProperties)||void 0===c?void 0:c.skipWelcome]);var F=p||{},G=F.subscribedEvents,U=F.eventHandler,$=o.useMemo((function(){return U}),[]);return o.useEffect((function(){return function(n,e,t,o){var i,r;n&&e&&t&&!1===(null===(r=o)||void 0===r||null===(i=r.localChatClientState)||void 0===i?void 0:i.isEventHandlerRegistered)&&n.on(e,t)}(_,G,$,q),function(){!function(n,e,t,o,i,r){t&&r&&o&&i&&(t.off(o,i),e.writeQuery({query:n,data:{localChatClientState:b(f({},r.localChatClientState),{isEventHandlerRegistered:!1})}}))}(k,B,_,G,$,q)}}),[_,G,$,q,B]),null};j.displayName="sharedui-VirtualAgentControl"}}]);
//# sourceMappingURL=https://bernie-assets.s3.us-west-2.amazonaws.com/blossom-flex-ui/shared-ui-customer-virtual-agent-control.c50786783ffbcdc74a6c.js.map